from defabipedia import Chain

from roles_royce import Operation
from roles_royce.protocols import aura
from roles_royce.protocols.multisend import MultiSend


def test_exect_transaction_with_role():
    approve = aura.ApproveAURABal(amount=123)
    deposit = aura.DepositBPT(pool_id=122, amount=99768376997984391577003)
    multisend = MultiSend.from_transactables(blockchain=Chain.ETHEREUM, txns=[approve, deposit])
    assert multisend.operation == Operation.DELEGATE_CALL
    assert multisend.value == 0
    assert (
        multisend.data
        == "0x8d80ff0a000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000001520000a7ba8ae7bca0b10a32ea1f8e2a1da980c6cad200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000044095ea7b3000000000000000000000000616e8bfa43f920657b3497dbf40d6b1a02d4608d000000000000000000000000000000000000000000000000000000000000007b00a57b8d98dae62b26ec3bcc4a365338157060b2340000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006443a0d066000000000000000000000000000000000000000000000000000000000000007a000000000000000000000000000000000000000000001520745dac26a092bdab00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000"
    )
    assert multisend.contract_address == "0xA238CBeb142c10Ef7Ad8442C6D1f9E89e07e7761"
